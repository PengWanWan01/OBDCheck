//
//  DashboardViewStyleB.m
//  OBDCheck
//
//  Created by yutaozhao on 2017/8/15.
//  Copyright ¬© 2017Âπ¥ Auptophix. All rights reserved.
//

#import "DashboardViewStyleB.h"
#define KMultipleB  self.bounds.size.width/300
@interface DashboardViewStyleB()
{
    CGPoint _center; // ‰∏≠ÂøÉÁÇπ
    gradientView *view;
    //Ê∑ªÂä†‰ª™Ë°®Áõò Â∫ïÈÉ®ÁöÑÂÜÖÂÆπ
    UIImageView *image2;
    UIImageView *innerimage;
    CALayer *containerLayer;
    CAShapeLayer *circleLayer;
    UIBezierPath *polygonPath;
    CAShapeLayer *polygonLayer;
    CAShapeLayer *lineLayer;
}
@end
@implementation DashboardViewStyleB

- (instancetype)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        self.userInteractionEnabled = YES;
        //Ê∑ªÂä†‰ª™Ë°®ÁõòÁöÑÂ∫ïÁõò
        self.image = [UIImage imageNamed:@"Dashboard"];
        self.contentMode = UIViewContentModeScaleAspectFill;
        _center = CGPointMake(ViewWidth / 2, ViewWidth / 2);
        
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(getNewNumber:) name:@"StyleBupdateNumber"object:nil];
        
        
    }
    return self;
}
//- (void)setNeedsLayout{
//    [super setNeedsLayout];
//    DLog(@"‰Ω†Â•Ωüëã");
//    self.image = [UIImage imageNamed:@"Dashboard"];
//    self.contentMode = UIViewContentModeScaleAspectFill;
//    _center = CGPointMake(ViewWidth / 2, ViewWidth / 2);
//    view.frame = self.bounds;
//    view.layer.cornerRadius = self.bounds.size.width/2;
//    image2.frame = CGRectMake(self.bounds.size.width/2 - 100*KMultipleB, self.bounds.size.width -73.0*KMultipleB , 200.0*KMultipleB,  70.0*KMultipleB);
//    view.gradientRadius = self.frame.size.width;
//    innerimage.frame = CGRectMake(43.0*KMultipleB, 43.0*KMultipleB, self.bounds.size.width - 86.0*KMultipleB,  self.bounds.size.width - 86.0*KMultipleB);
//    _UnitLabel.frame = CGRectMake(0, 2*innerimage.frame.size.height/3, innerimage.frame.size.width, innerimage.frame.size.height/3);
//    _NumberLabel.frame = CGRectMake(0,innerimage.frame.size.height/3, innerimage.frame.size.width, innerimage.frame.size.height/3);
//    _PIDLabel.frame = CGRectMake(0, 0, innerimage.frame.size.width, innerimage.frame.size.height/3);
//    _NumberLabel.font =    [UIFont fontWithName:@"DBLCDTempBlack"size:56.0*KMultipleB];
//    _UnitLabel.font = [UIFont boldSystemFontOfSize:17*KMultipleB];
//    [_triangleView removeFromSuperview];
//    _triangleView = [[UIView alloc]initWithFrame:CGRectMake(self.bounds.size.width /2 - 30*KMultipleB/2, 7*KMultipleB, 30*KMultipleB, (self.bounds.size.width /2)-7*KMultipleB)];
//    //    _triangleView.backgroundColor = [UIColor redColor];
//    CGPoint oldOrigin = _triangleView.frame.origin;
//    //ËÆæÁΩÆtriangleViewÁöÑËßíÂ∫¶‰∏éÂºÄÂßã‰ΩçÁΩÆ‰∏ÄÁõ¥
//    _triangleView.layer.anchorPoint = CGPointMake(0.5, 1);
//    CGPoint newOrigin = _triangleView.layer.frame.origin;
//    
//    CGPoint transition;
//    transition.x = newOrigin.x - oldOrigin.x;
//    transition.y = newOrigin.y - oldOrigin.y;
//    _triangleView.center = CGPointMake (_triangleView.center.x - transition.x, _triangleView.center.y - transition.y);
//    _triangleView.transform = CGAffineTransformMakeRotation(-M_PI/2-M_PI/4);
//    [self addSubview:_triangleView];
//    
//    // Á∫øÁöÑË∑ØÂæÑ ‰∏âËßíÂΩ¢
//    polygonPath = [UIBezierPath bezierPath];
//    
//    [polygonPath moveToPoint:CGPointMake(15*KMultipleB, 36.0*KMultipleB/2)];
//    // ÂÖ∂‰ªñÁÇπ
//    [polygonPath addLineToPoint:CGPointMake(0, 0)];
//    [polygonPath addLineToPoint:CGPointMake(30*KMultipleB, 0)];
//    
//    [polygonPath closePath]; // Ê∑ªÂä†‰∏Ä‰∏™ÁªìÂ∞æÁÇπÂíåËµ∑ÁÇπÁõ∏Âêå
//    
//    polygonLayer = [CAShapeLayer layer];
//    polygonLayer.lineWidth = 2;
//    
//    [_triangleView.layer addSublayer:polygonLayer];
//    //ÁîªÁõ¥Á∫ø
//    // Á∫øÁöÑË∑ØÂæÑ
//    UIBezierPath *linePath = [UIBezierPath bezierPath];
//    // Ëµ∑ÁÇπ
//    [linePath moveToPoint:CGPointMake(15*KMultipleB, 36.0*KMultipleB/2)];
//    // ÂÖ∂‰ªñÁÇπ
//    [linePath addLineToPoint:CGPointMake(15*KMultipleB, 36.0*KMultipleB)];
//    
//    lineLayer = [CAShapeLayer layer];
//    
//    lineLayer.lineWidth = 2;
//    
//    lineLayer.path = linePath.CGPath;
//    lineLayer.fillColor = nil; // ÈªòËÆ§‰∏∫blackColor
//    
//    [_triangleView.layer addSublayer:lineLayer];
//    NSArray* pAllCount = [CustomDashboard findAll];
//    for (NSInteger i = 0;i<pAllCount.count;i++) {
//        CustomDashboard *dash = pAllCount[i];
//        if (dash.pk == self.tag) {
//            polygonLayer.strokeColor = [ColorTools colorWithHexString:dash.DashboardBpointerColor].CGColor;
//            polygonLayer.path = polygonPath.CGPath;
//            polygonLayer.fillColor = [ColorTools colorWithHexString:dash.DashboardBpointerColor].CGColor; //
//            lineLayer.strokeColor = [ColorTools colorWithHexString:dash.DashboardBpointerColor].CGColor;
//        }
//    }
//    
//    
//    CGPoint _c = CGPointMake(self.bounds.size.width/2   , self.bounds.size.width/2 );
//    CGFloat _r = self.bounds.size.width/2 - (23.0/300)*self.bounds.size.width;
//    BOOL clockwise = YES; // È°∫Êó∂Èíà
//    UIBezierPath *circlePath = [UIBezierPath bezierPathWithArcCenter:_c radius:_r startAngle:(M_PI / 2) endAngle:M_PI *3/4-M_PI/18 clockwise:clockwise];
//    circleLayer.path = circlePath.CGPath;
//}
-(void)layoutSubviews{
    [super layoutSubviews];
    if (isLandscape) {
        //        DLog(@"ËßÜÂõæÊ®™Â±è");
        [self setHorizontalFrame];
    }else{
        //        DLog(@"ËßÜÂõæÁ´ñÂ±è");
        [self setVerticalFrame];
    }
    
    
}
- (void)setHorizontalFrame{
    CustomDashboard *dash = [CustomDashboard findByPK:self.tag];
    int page =  [dash.Dashboardorignx doubleValue]/SCREEN_MIN;
    if (page == 0) {
        if (([dash.Dashboardorignx floatValue]-page*SCREEN_MIN)>SCREEN_MIN/2) {
            //Ê®™Â±èÊó∂ÂÄô‰∏äËæπÁöÑ‰∏ÄÊéí‰ª™Ë°®Áõò
            self.frame = CGRectMake([dash.Dashboardorigny floatValue]+55+page*SCREEN_MAX+15*KFontmultiple, SCREEN_MIN -([dash.Dashboardorignx floatValue]-page*SCREEN_MIN+10*KFontmultiple)-([dash.Dashboardorignheight doubleValue]), [dash.Dashboardorignwidth doubleValue]-30*KFontmultiple, [dash.Dashboardorignheight doubleValue]-30*KFontmultiple);
            self.transform=CGAffineTransformScale(CGAffineTransformIdentity, 0.85, 0.85);
        }else{
            self.frame = CGRectMake([dash.Dashboardorigny floatValue]+55+page*SCREEN_MAX+15*KFontmultiple, SCREEN_MIN -([dash.Dashboardorignx floatValue]-page*SCREEN_MIN+30*KFontmultiple)-([dash.Dashboardorignheight doubleValue]), [dash.Dashboardorignwidth doubleValue]-30*KFontmultiple, [dash.Dashboardorignheight doubleValue]-30*KFontmultiple);
            self.transform=CGAffineTransformScale(CGAffineTransformIdentity, 0.85, 0.85);
        }
      
    }else{
     self.frame = CGRectMake([dash.Dashboardorigny floatValue]+page*SCREEN_MAX+57,[dash.Dashboardorignx floatValue]-page*SCREEN_MIN-35, [dash.Dashboardorignwidth doubleValue] ,[dash.Dashboardorignheight doubleValue]);
     self.transform=CGAffineTransformScale(CGAffineTransformIdentity, 1, 1);
        }
}
- (void)setVerticalFrame{
    CustomDashboard *dash = [CustomDashboard findByPK:self.tag];
    self.frame = CGRectMake([dash.Dashboardorignx doubleValue],[dash.Dashboardorigny doubleValue], [dash.Dashboardorignwidth doubleValue], [dash.Dashboardorignheight doubleValue]);
    DLog(@"ÂæóÂà∞%ldÁ´ñÂ±èÂêé%f %f",self.tag,[dash.Dashboardorignx doubleValue], [dash.Dashboardorigny doubleValue] );
    self.transform=CGAffineTransformScale(CGAffineTransformIdentity, 1, 1);

}
- (void)getNewNumber:(NSNotification *)text{
    
    NSString *presentStr = [NSString stringWithFormat:@"%@", [text.userInfo objectForKey:@"StyleBViewnumber"]];
    NSString *PreviouStr = [NSString stringWithFormat:@"%@", [text.userInfo objectForKey:@"PreStyleBViewnumber"]];
    
    CGFloat start = [PreviouStr floatValue];
    CGFloat end = [presentStr floatValue];
    if ([text.userInfo[@"StyleBViewTag"] floatValue] == self.tag) {
        
        
        
//        switch ([[UserDefaultSet sharedInstance] GetIntegerAttribute:@"dashboardMode"]) {
//            case DashboardCustomMode:
//            {
                NSArray *list = [CustomDashboard findAll];
                for(CustomDashboard* dashboard in list){
                    CGFloat Space =   (3*M_PI/2)/([dashboard.DashboardmaxNumber floatValue] - [dashboard.DashboardminNumber floatValue]);
                    [self rotateImageView:(-M_PI/2-M_PI/4) + Space*start Withend:(-M_PI/2-M_PI/4) +Space*end];
                    
                }
//            }
//                break;
//            case DashboardClassicMode:
//            {
//                NSArray* pAll = [CustomDashboard findAll];
//                for(CustomDashboard * dashboard in pAll){
//                    CGFloat Space =   (3*M_PI/2)/([dashboard.DashboardBmaxNumber floatValue] - [dashboard.DashboardBminNumber floatValue]);
//                    [self rotateImageView:(-M_PI/2-M_PI/4) + Space*start Withend:(-M_PI/2-M_PI/4) +Space*end];
//
//                }
//            }
//                break;
//            default:
//                break;
//        }
    }
    
    
    
}
- (void)dealloc{
    [[NSNotificationCenter defaultCenter] removeObserver:self];
    
}
- (void)initWithModel:(CustomDashboard *)model{
    view = [[gradientView alloc]initWithFrame:self.bounds];
    view.gradientRadius = [model.DashboardBGradientRadius floatValue];
    view.startGradientColor =  [ColorTools colorWithHexString:model.DashboardBbackColor];
    view.endGradientColor =  [UIColor clearColor];
    [self addSubview:view];
    //Ê∑ªÂä†‰ª™Ë°®Áõò‰∏≠Èó¥ÁöÑÂÜÖÂÆπ
    [self addmiddle:model.DashboardBtitleColor TitlteFontScale:[model.DashboardBtitleFontScale floatValue] TitlePositon:[model.DashboardBtitlePositon floatValue] ValueVisible:model.DashboardBValueVisible Valuecolor:model.DashboardBValueColor ValueFontScale:[model.DashboardBValueFontScale floatValue] ValuePositon:[model.DashboardBValuePositon floatValue] UnitColor:model.DashboardBUnitColor UnitFontScale:[model.DashboardBUnitFontScale floatValue] UnitPositon:[model.DashboardBUnitPositon floatValue] withmoel:(CustomDashboard *)model  ];
    
    //Ê∑ªÂä†‰ª™Ë°®Áõò Â∫ïÈÉ®ÁöÑÂÜÖÂÆπ
    image2 = [[UIImageView alloc]initWithFrame:CGRectMake(self.frame.size.width/2 - 100*KMultipleB, self.frame.size.width -73.0*KMultipleB , 200.0*KMultipleB,  70.0*KMultipleB)];
    image2.image = [UIImage imageNamed:@"yuanhu"];
    image2.contentMode = UIViewContentModeScaleAspectFill;
    
    [self addSubview:image2];
    
    //Ê∑ªÂä†ËøõÂ∫¶Êù°
    //    [self draw:self.frame.size.width/2 - 23.0*KMultipleB lineWidth:12.0*KMultipleB lineColor:[ColorTools colorWithHexString:@"1d2027"] startAngle:(M_PI / 4) +(M_PI/18) endAngle: M_PI *3/4-M_PI/18];
    
    [self draw:self.frame.size.width/2 - (23.0/300)*self.frame.size.width lineWidth:12.0*KMultipleB lineColor:[ColorTools colorWithHexString:model.DashboardBFillColor] startAngle:(M_PI / 2) endAngle: M_PI *3/4-M_PI/18];
    [self adddrawPointColor:model.DashboardBpointerColor PointWidth:[model.DashboardBPointerwidth floatValue] Fillenable:model.DashboardBFillEnable   FillColor:model.DashboardBFillColor];
    UILongPressGestureRecognizer *LongPress = [[UILongPressGestureRecognizer alloc]initWithTarget:self action:@selector(tap:)];
    [self addGestureRecognizer:LongPress];
    if ([[UserDefaultSet sharedInstance] GetIntegerAttribute:@"dashboardMode"] == DashboardCustomMode ) {
        UIPinchGestureRecognizer* pinchGR = [[UIPinchGestureRecognizer alloc] initWithTarget:self action:@selector(pinchAction:)];
        [self addGestureRecognizer:pinchGR];
    }
}
-(void)tap:(UILongPressGestureRecognizer *)sender{
    if ([self.delegate respondsToSelector:@selector(tap:)]) {
        [self.delegate tap:sender];
    }
}
#pragma mark ÊçèÂêàÊâãÂäø
- (void)pinchAction:(UIPinchGestureRecognizer*)recognizer{
    
    if (recognizer.state==UIGestureRecognizerStateBegan || recognizer.state==UIGestureRecognizerStateChanged)
        
    {
        //        UIView *view=[recognizer view];
        //Êâ©Â§ß„ÄÅÁº©Â∞èÂÄçÊï∞
        self.transform=CGAffineTransformScale(self.transform, recognizer.scale, recognizer.scale);
        recognizer.scale=1;
        if ([self.delegate respondsToSelector:@selector(pinchtap:OrignX:OrignY:Width:Height:)]) {
            [self.delegate pinchtap:recognizer OrignX:self.frame.origin.x OrignY:self.frame.origin.y Width:self.frame.size.width Height:self.frame.size.height];
        }
    }
    
}
#pragma markÁîªÊåáÈíà ÂúÜ‰∏é‰∏âËßíÂΩ¢
- (void)rotateImageView:(CGFloat)StartAngle Withend:(CGFloat)endAngle {
    CGPoint oldOrigin = _triangleView.frame.origin;
    //ËÆæÁΩÆtriangleViewÁöÑËßíÂ∫¶‰∏éÂºÄÂßã‰ΩçÁΩÆ‰∏ÄÁõ¥
    _triangleView.layer.anchorPoint = CGPointMake(0.5, 1);
    CGPoint newOrigin = _triangleView.layer.frame.origin;
    
    CGPoint transition;
    transition.x = newOrigin.x - oldOrigin.x;
    transition.y = newOrigin.y - oldOrigin.y;
    
    _triangleView.center = CGPointMake (_triangleView.center.x - transition.x, _triangleView.center.y - transition.y);
    CABasicAnimation *animation = [CABasicAnimation new];
    // ËÆæÁΩÆÂä®ÁîªË¶ÅÊîπÂèòÁöÑÂ±ûÊÄß
    animation.keyPath = @"transform.rotation.z";
    animation.fromValue = @(endAngle);
    // Âä®ÁîªÁöÑÊúÄÁªàÂ±ûÊÄßÁöÑÂÄºÔºàÔºâ
    animation.toValue = @(StartAngle);
    // Âä®ÁîªÁöÑÊí≠ÊîæÊó∂Èó¥
    animation.duration = 1;
    //    animation.repeatCount = 1;
    
    // Âä®ÁîªÊïàÊûúÊÖ¢ËøõÊÖ¢Âá∫
    animation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
    // Ëß£ÂÜ≥Âä®ÁîªÁªìÊùüÂêéÂõûÂà∞ÂéüÂßãÁä∂ÊÄÅÁöÑÈóÆÈ¢ò
    animation.removedOnCompletion = NO;
    animation.fillMode = kCAFillModeForwards;
    // Â∞ÜÂä®ÁîªÊ∑ªÂä†Âà∞ËßÜÂõæbgImgVÁöÑlayer‰∏ä
    [_triangleView.layer addAnimation:animation forKey:@"rotation"];
    
}
- (void)adddrawPointColor:(NSString *)PointColor PointWidth:(CGFloat )PointWidth Fillenable:(BOOL)fillenable   FillColor:(NSString *)fillColor{
    
    polygonLayer.strokeColor = [ColorTools colorWithHexString:PointColor].CGColor;
    polygonLayer.path = polygonPath.CGPath;
    polygonLayer.fillColor = [ColorTools colorWithHexString:PointColor].CGColor; //
    lineLayer.strokeColor = [ColorTools colorWithHexString:PointColor].CGColor;
    
}

- (void)addmiddle:(NSString *)titlteColor TitlteFontScale:(CGFloat )titlteFontScale TitlePositon:(CGFloat)titlePositon ValueVisible:(BOOL )valueVisible Valuecolor:(NSString *)ValueColor  ValueFontScale:(CGFloat)valueFontScale ValuePositon:(CGFloat)valuePositon UnitColor:(NSString *)unitColor UnitFontScale:(CGFloat)unitFontScale  UnitPositon:(CGFloat)unitPositon withmoel:(CustomDashboard *)model {
    
    innerimage = [[UIImageView alloc]initWithFrame:CGRectMake(43.0*KMultipleB, 43.0*KMultipleB, self.frame.size.width - 86.0*KMultipleB,  self.frame.size.width - 86.0*KMultipleB)];
    innerimage.image = [UIImage imageNamed:@"circle-top"];
    innerimage.contentMode = UIViewContentModeScaleAspectFill;
    [self addSubview:innerimage];
    
    _NumberLabel = [[UILabel alloc] initWithFrame:CGRectMake(0,innerimage.frame.size.height/3, innerimage.frame.size.width, innerimage.frame.size.height/3)];
    _NumberLabel.font =    [UIFont fontWithName:@"DBLCDTempBlack"size:56.0*KMultipleB*valueFontScale];
    
    _NumberLabel.textColor = [ColorTools colorWithHexString: ValueColor];
    
    _NumberLabel.textAlignment = NSTextAlignmentCenter;
    _NumberLabel.text = @"2500";
    
    if (model.DashboardBValueVisible == YES) {
        [innerimage addSubview:_NumberLabel];
    }else{
        
    }
    
    _PIDLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, innerimage.frame.size.width, innerimage.frame.size.height/3)];
    _PIDLabel.font = [UIFont boldSystemFontOfSize:24.0*KMultipleB*titlteFontScale];
    _PIDLabel.textColor =[ColorTools colorWithHexString: titlteColor];
    _PIDLabel.textAlignment = NSTextAlignmentCenter;
    _PIDLabel.text = model.DashboardPID;
    [innerimage addSubview:_PIDLabel];
    _UnitLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 2*innerimage.frame.size.height/3, innerimage.frame.size.width, innerimage.frame.size.height/3)];
    _UnitLabel.font = [UIFont boldSystemFontOfSize:17*KMultipleB*unitFontScale];
    _UnitLabel.textColor =  [ColorTools colorWithHexString:unitColor];
    _UnitLabel.textAlignment = NSTextAlignmentCenter;
    _UnitLabel.text = @"km/h";
    
    [innerimage addSubview:_UnitLabel];
}
- (void)draw:(CGFloat )radius lineWidth:(CGFloat)width lineColor:(UIColor *)color startAngle:(CGFloat)start endAngle:(CGFloat)end{
    CGPoint _c = CGPointMake(self.frame.size.width/2   , self.frame.size.width/2 );
    CGFloat _r = radius;
    CGFloat startAngle =start; // ÂºÄÂßãËßíÂ∫¶
    CGFloat endAngle = end; // ÁªìÊùüËßíÂ∫¶
    BOOL clockwise = YES; // È°∫Êó∂Èíà
    
    containerLayer = [CALayer layer];
    
    // ÁéØÂΩ¢LayerÂ±Ç
    circleLayer = [CAShapeLayer layer];
    circleLayer.lineWidth = width;
    //    circleLayer.lineCap = kCALineCapRound;
    //    circleLayer.lineJoin = kCALineJoinMiter;
    circleLayer.fillColor = [UIColor clearColor].CGColor;
    circleLayer.strokeColor = color.CGColor;
    
    // path
    UIBezierPath *circlePath = [UIBezierPath bezierPathWithArcCenter:_c radius:_r startAngle:startAngle endAngle:endAngle clockwise:clockwise];
    circleLayer.path = circlePath.CGPath;
    
    [containerLayer addSublayer:circleLayer];
    
    [ self.layer addSublayer:containerLayer];
    
    
}
#pragma mark ÂºÄÂßãÁÇπÂáª
- (void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    DLog(@"chumochumo");
    //ËØ•viewÁΩÆ‰∫éÊúÄÂâç
    
    //‰øùÂ≠òËß¶Êë∏Ëµ∑ÂßãÁÇπ‰ΩçÁΩÆ
    if ([DashboardSetting sharedInstance].isDashboardMove == YES && [DashboardSetting sharedInstance].Dashboardindex == self.tag) {
        
    }
}

-(void) touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    
    //ËÆ°ÁÆó‰ΩçÁßª=ÂΩìÂâç‰ΩçÁΩÆ-Ëµ∑Âßã‰ΩçÁΩÆ
    if ([DashboardSetting sharedInstance].isDashboardMove == YES  && [DashboardSetting sharedInstance].Dashboardindex == self.tag) {
        //ÂÅöUIViewÊãñÊãΩ
        UITouch *touch = [touches anyObject];
        
        
        //Ê±ÇÂÅèÁßªÈáè = ÊâãÊåáÂΩìÂâçÁÇπÁöÑX - ÊâãÊåá‰∏ä‰∏Ä‰∏™ÁÇπÁöÑX
        CGPoint curP = [touch locationInView:self];
        CGPoint preP = [touch previousLocationInView:self];
        //        DLog(@"curP====%@",NSStringFromCGPoint(curP));
        //        DLog(@"preP====%@",NSStringFromCGPoint(preP));
        
        CGFloat offsetX = curP.x - preP.x;
        CGFloat offsetY = curP.y - preP.y;
        
        //Âπ≥Áßª
        self.transform = CGAffineTransformTranslate(self.transform, offsetX, offsetY);
    }
    
}
- (void)touchesEnded:(NSSet<UITouch *> *)touches withEvent:(UIEvent *)event{
    
    if ([DashboardSetting sharedInstance].isDashboardMove == YES  && [DashboardSetting sharedInstance].Dashboardindex == self.tag) {
        
        if ([self.delegate respondsToSelector:@selector(touchMoveWithcenterX:WithcenterY:)]) {
            DLog(@"origin%f,%f",self.frame.origin.x,self.frame.origin.y );
            [self.delegate touchMoveWithcenterX:self.frame.origin.x WithcenterY:self.frame.origin.y];
            //ÁßªÂä®view
        }
    }
    
    
}
@end

